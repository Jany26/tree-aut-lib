## A library for working with tree automata

This project was created for the purposes of testing the effectivity 
of using tree automata (TAs) in binary decision diagrams (BDDs) 
as a means of their reduction.

Part of a work on an article on ABDDs = Automata-based Binary Decision Diagrams.

# Authors

Student: Jany26 / Jan Matufka <xmatuf00@stud.fit.vutbr.cz>
Supervisor: ondrik / Ing. Ondrej Lengal, PhD. <lengal@fit.vutbr.cz>

## File structure and content

# Source code files

`cpp/` - contains C++ parser for BLIF files and DIMACS files using BuDDy library

* `blif_parser.cpp`     ... BlifParser implementation (supports only .names constructs), can convert combinational circuit BLIF description into a BDD (or multiple BDDs)
* `blif_parser.h`       ... BlifParser class
* `dimacs_parser.cpp`   ... DimacsParser class + implementation (.cnf files)
* `tree_aut.cpp`        ... some preliminary work on designing tree automata classes in C++

`py/` - these files implement the functions and algorithms for tree automata and ABDDs

* `adhoc_tester.py`         ... not important - only used for some testing/debugging
* `all_tests.py`            ... contains test suites for regression testing for all functions from other modules
* `bdd_apply.py`                ... Python implementation of BDD apply operations (not efficient)
* `bdd.py`                  ... BDD class + iterators, functions etc.
* `blif_analysis.py`        ... script for running BLIF tests
* `blif_parser.py`          ... Python implementation of BLIF parsing (use the upgraded, faster C++ version)
* `coocurrence.py`          ... preliminary (so far unsuccessful) work on trying to total order over boxes via language inclusion checking
* `dimacs_analysis.py`      ... script for running DIMACS tests
* `dimacs.py`               ... Python implementation of DIMACS parser (use the upgraded, faster C++ version)
* `folding_helpers.py`      ... helping functions for folding (extra checks, etc.)
* `folding_intersectoid.py` ... algorithms on intersectoid creating and modifying
* `folding.py`              ... implementation of main algorithms behind *folding*
* `format_abdd.py`          ... import/export TTreeAut into ABDD format
* `format_dot.py`           ... export TA to DOT format (text-file)
* `format_tmb.py`           ... import/export TA to/from TMB format
* `format_vtf.py`           ... import/export TA to/from (modified) VATA format
* `normalization.py`        ... main *normalization* algorithm + all supporting functions
* `render_dot.py`           ... export TA to DOT format (images) using `graphviz` library
* `simulation.py`           ... equivalence testing - iterating over all assignments
* `ta_classes.py`           ... *basic classes* (TTreeAut, TEdge, TTransition, TTreeNode)
* `ta_functions.py`         ... *treeaut library* (basic TA operations)
* `test_data.py`            ... helpful structures used in tests (mainly TAs)
* `test_trees.py`           ... small tree examples used in tests (+ helping functions)
* `unfolding.py`            ... *unfolding* algorithm + helping functions
* `utils.py`                ... boxOrders and some debug functions

These files serve as a documentation/demonstration of Tree automata library usage:

* `1-introduction.ipynb`
* `2a-boxes.ipynb`
* `2b-match.ipynb`
* `3-nonEmptiness.ipynb`
* `4-operations.ipynb`
* `5-reachability.ipynb`
* `6-unfolding.ipynb`
* `7-normalization.ipynb`
* `8-folding.ipynb`

# Test files and results

`tests/` - test files used in `all_tests.py`

* `tests/blif`            ... preprocessed BLIF benchmarks (abdd)
* `tests/blif-report.txt` ... BLIF benchmarks metadata (node count and root node number), also used as input for tests (commented lines are skipped)

`benchmark/` - contains benchmarks that were used in results (not all benchmarks were tested)

* `benchmark/blif/`     ... BLIF files representing combinational circuits used as benchmarks (C432, C499, C880, C1355, C1908 were tested)
* `benchmark/dimacs/`   ... DIMACS format - CNF functions - 20var, 50var, 100var (only 20var were tested so far)
* `benchmark/ntas/`     ... test TAs - larger, more complex than in basic tests  - more info at https://github.com/ondrik/automata-benchmarks

`results` - node counts and box usage statistics results (+ scripts to generate figures)

* `results/csv`     ... csv data for node counts and box usage from DIMACS and BLIF benchmark testing
* `results/figures` ... graphs of results (generated by python scripts located in `results`)
* `results/raw`     ... raw results in a more readable format

`data/` - used for storing output/processed data, images, debugging information, reports, etc. ... 

These 4 subfolders are created when using `make test` (deleted using `make clean`)
* `data/dot/`            ... output data from export to DOT format
* `data/tmb/`            ... output data from export to TMB format
* `data/vtf/`            ... output data from export to VTF format
* `data/vtf-to-dot/`     ... output data from export to DOT from VTF format

These subfolders are used for storing pre-processed data, analyzed information about tests, etc.
* `data/blif-normalized` ... normalized UBDAs from BLIF benchmarks (for faster testing)
* `data/blif-reports`    ... text files with reports of node counts of each subtree of benchmarks (for getting trimmed results for testing/debugging/etc.)
* `data/uf20`            ... preprocessed dimacs benchmarks

# Additional Notes

To run some folding tests, use these scripts in `py/` folder:

`python3 blif_analysis.py`
`python3 dimacs_analysis.py`

`blif_analysis` runs BLIF benchmark folding tests, currently set to only run C432 benchmark tests, if you want to change which tests are run, edit file `tests/blif-report.txt` (remove '#' or put '#' at the start of each line)

`dimacs_analysis` runs DIMACS benchmark folding tests

- if you want to get box counts (ABDD), uncomment the proper line at the bottom of corresponding scripts

`cd cpp && make` creates binaries for blif_parser and dimacs_parser

`./cpp/bin/blif_parser BLIF_PATH OUTPUTS_FOLDER [smartvars]`

`./cpp/bin/dimacs_parser`
